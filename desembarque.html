<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Tabla desde JSON</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }
    th, td {
      border: 1px solid #444;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>

  <h1>Buscar Empresa</h1>
  <input type="text" id="busqueda" placeholder="Escribe el nombre de la empresa">
  <button id="btnBuscar">Buscar</button>
  <button id="btnMostrar">Mostrar todas</button>

  <h2>Datos desde JSON</h2>
  <table id="tabla-datos">
    <thead>
      <tr>
        <th>Empresa</th>
        <th>Origen</th>
        <th>Placa</th>
        <th>Fecha</th>
        <th>Entrada</th>
        <th>Salida</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let datosGlobales = [];

    window.onload = function () {
      const inputBusqueda = document.getElementById("busqueda");
      const btnBuscar = document.getElementById("btnBuscar");
      const btnMostrar = document.getElementById("btnMostrar");
      const tbody = document.querySelector('#tabla-datos tbody');

      if (!inputBusqueda || !btnBuscar || !btnMostrar || !tbody) {
        console.error("No se encontraron elementos del DOM.");
        return;
      }

      // Cargar los datos JSON al iniciar
      fetch('csvjson.json')
        .then(response => response.json())
        .then(data => {
          datosGlobales = data;
          mostrarDatosEnTabla(data); // Mostrar todos al inicio
        })
        .catch(error => {
          console.error('Error al cargar csvjson.json:', error);
          alert('No se pudo cargar el archivo JSON.');
        });

      // Buscar empresa por nombre exacto
      btnBuscar.addEventListener("click", function () {
        const nombre = inputBusqueda.value.trim().toUpperCase();
        const coincidencias = datosGlobales.filter(item =>
          item.Empresa.toUpperCase() === nombre
        );
        mostrarDatosEnTabla(coincidencias);
      });

      // Mostrar todos los registros
      btnMostrar.addEventListener("click", function () {
        mostrarDatosEnTabla(datosGlobales);
      });
    };

    function mostrarDatosEnTabla(datos) {
      const tbody = document.querySelector('#tabla-datos tbody');
      tbody.innerHTML = '';

      if (datos.length === 0) {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td colspan="6" style="color:red;">No se encontraron datos</td>`;
        tbody.appendChild(tr);
        return;
      }

      datos.forEach(item => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${item.Empresa}</td>
          <td>${item.Origen}</td>
          <td>${item.Placa}</td>
          <td>${item.Fecha}</td>
          <td>${item.Entrada}</td>
          <td>${item.Salida}</td>
        `;
        tbody.appendChild(tr);
      });
    }
  </script>
</body>
</html>

